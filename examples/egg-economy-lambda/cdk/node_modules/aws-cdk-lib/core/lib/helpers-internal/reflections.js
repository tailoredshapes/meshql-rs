"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.findClosestRelatedResource=findClosestRelatedResource,exports.findL1FromRef=findL1FromRef;var cfn_resource_1=()=>{var tmp=require("../cfn-resource");return cfn_resource_1=()=>tmp,tmp};function findClosestRelatedResource(primary,relatedCfnResourceType,isConnected){let closestMatch,closestDistance=1/0;const visited=new Set,isRelatedResource=child=>cfn_resource_1().CfnResource.isCfnResource(child)&&child.cfnResourceType===relatedCfnResourceType,checkCandidate=(candidate,distance)=>{isRelatedResource(candidate)&&isConnected(primary,candidate)&&distance<closestDistance&&(closestMatch=candidate,closestDistance=distance)},searchChildren=(parent,distance)=>{if(!(distance>=closestDistance))for(const child of parent.node.children)visited.has(child)||(visited.add(child),checkCandidate(child,distance),searchChildren(child,distance+1))};searchChildren(primary,1);let ancestor=primary.node.scope,ancestorDistance=1;for(;ancestor&&ancestorDistance<closestDistance;){for(const sibling of ancestor.node.children)searchChildren(sibling,ancestorDistance);ancestor=ancestor.node.scope,ancestorDistance++}return closestMatch}function findL1FromRef(ref,cfnResourceType,compareIdToCfnId){const isCfnMatch=construct=>cfn_resource_1().CfnResource.isCfnResource(construct)&&construct.cfnResourceType===cfnResourceType;return isCfnMatch(ref)?ref:ref.node.defaultChild&&isCfnMatch(ref.node.defaultChild)?ref.node.defaultChild:findClosestRelatedResource(ref,cfnResourceType,(_,candidate)=>compareIdToCfnId(candidate,ref))}
